<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯—éŸµÂ·äºŒç»´ç ç”Ÿæˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #4f46e5, #7c3aed);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 8px;
            font-weight: 300;
            letter-spacing: 2px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            font-style: italic;
            color: #f8fafc;
            letter-spacing: 1px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            padding: 40px;
        }

        .controls-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .preview-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .input-field:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .color-presets {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
            max-height: 120px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .color-presets.expanded {
            max-height: none;
        }

        .color-toggle {
            margin-top: 10px;
            text-align: center;
        }

        .toggle-btn {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            color: #6b7280;
            transition: all 0.3s ease;
        }

        .toggle-btn:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .color-preset {
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .color-preset:hover {
            border-color: #4f46e5;
            background: #f0f4ff;
        }

        .color-preset.active {
            border-color: #4f46e5;
            background: #e0e7ff;
            color: #4f46e5;
        }

        .color-preview {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin: 0 auto 5px;
            border: 2px solid #e5e7eb;
        }

        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            background: #f9fafb;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #4f46e5;
            background: #f0f4ff;
        }

        .upload-area.dragover {
            border-color: #4f46e5;
            background: #e0e7ff;
        }

        .upload-icon {
            font-size: 2rem;
            color: #9ca3af;
            margin-bottom: 10px;
        }

        .upload-text {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .upload-input {
            display: none;
        }

        .logo-preview {
            display: none;
            margin-top: 15px;
            text-align: center;
        }

        .logo-preview img {
            max-width: 100px;
            max-height: 100px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .remove-logo {
            margin-top: 10px;
            background: #ef4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
        }

        .remove-logo:hover {
            background: #dc2626;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 10px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            color: #6b7280;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }

        .action-btn.reset {
            color: #dc2626;
            border-color: #fca5a5;
        }

        .action-btn.reset:hover {
            background: #fef2f2;
            border-color: #ef4444;
        }

        .btn {
            padding: 15px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #4f46e5, #7c3aed);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 2px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .qr-display {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qr-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .qr-image:hover {
            transform: scale(1.05);
        }

        .loading {
            display: none;
            color: #4f46e5;
            font-size: 1rem;
            margin-top: 15px;
        }

        .error {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 8px;
            display: none;
        }

        .success-message {
            background: #10b981;
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            margin-top: 15px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .button-group, .color-presets {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âœ¨ è¯—éŸµÂ·äºŒç»´ç ç”Ÿæˆå™¨</h1>
            <p>ã€Œç§‘æŠ€ä¸è‰ºæœ¯çš„äº¤ç»‡ï¼Œä»£ç ä¸è¯—æ„çš„èåˆã€</p>
        </div>

        <div class="main-content">
            <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
            <div class="controls-section">
                <h2 style="margin-bottom: 25px; color: #374151;">ğŸ“ ç”Ÿæˆè®¾ç½®</h2>
                
                <!-- å†…å®¹è¾“å…¥ -->
                <div class="form-group">
                    <label for="content">ğŸ“ å†…å®¹/URL</label>
                    <input type="text" id="content" class="input-field" placeholder="è¯·è¾“å…¥è¦è½¬æ¢çš„å†…å®¹æˆ–ç½‘å€" value="https://www.example.com">
                    <div class="error" id="contentError">è¯·è¾“å…¥å†…å®¹</div>
                </div>

                <!-- é«˜çº§é…è‰²æ–¹æ¡ˆ -->
                <div class="form-group">
                    <label>ğŸ¨ é«˜çº§é…è‰²</label>
                    <div class="color-presets">
                        <div class="color-preset active" data-foreground="#6B7280" data-background="#F3F4F6">
                            <div class="color-preview" style="background: linear-gradient(45deg, #6B7280 50%, #F3F4F6 50%);"></div>
                            <div>æ²‰ç¨³ç°è°ƒ</div>
                        </div>
                        <div class="color-preset" data-foreground="#64748B" data-background="#E2E8F0">
                            <div class="color-preview" style="background: linear-gradient(45deg, #64748B 50%, #E2E8F0 50%);"></div>
                            <div>é›¾éœ¾è“è°ƒ</div>
                        </div>
                        <div class="color-preset" data-foreground="#A16207" data-background="#FEF3C7">
                            <div class="color-preview" style="background: linear-gradient(45deg, #A16207 50%, #FEF3C7 50%);"></div>
                            <div>æ¸©æŸ”é©¼è‰²</div>
                        </div>
                        <div class="color-preset" data-foreground="#8B5CF6" data-background="#F3E8FF">
                            <div class="color-preview" style="background: linear-gradient(45deg, #8B5CF6 50%, #F3E8FF 50%);"></div>
                            <div>å¤å¤ç²‰ç´«</div>
                        </div>
                        <div class="color-preset" data-foreground="#059669" data-background="#D1FAE5">
                            <div class="color-preview" style="background: linear-gradient(45deg, #059669 50%, #D1FAE5 50%);"></div>
                            <div>é™è°§å†›ç»¿</div>
                        </div>
                        <div class="color-preset" data-foreground="#7C2D12" data-background="#FED7AA">
                            <div class="color-preview" style="background: linear-gradient(45deg, #7C2D12 50%, #FED7AA 50%);"></div>
                            <div>æ¸©æš–å’–å•¡</div>
                        </div>
                        <div class="color-preset" data-foreground="#0EA5E9" data-background="#E0F2FE">
                            <div class="color-preview" style="background: linear-gradient(45deg, #0EA5E9 50%, #E0F2FE 50%);"></div>
                            <div>å¤©ç©ºæ¸…è“</div>
                        </div>
                        <div class="color-preset" data-foreground="#8B9DC3" data-background="#F5F3FF">
                            <div class="color-preview" style="background: linear-gradient(45deg, #8B9DC3 50%, #F5F3FF 50%);"></div>
                            <div>è«å…°è¿ªç´«</div>
                        </div>
                    </div>
                    <div class="color-toggle">
                        <button class="toggle-btn" onclick="toggleColors()">ğŸ“ å±•å¼€æ›´å¤šé«˜çº§é…è‰²</button>
                    </div>
                </div>

                <!-- Logoä¸Šä¼  -->
                <div class="form-group">
                    <label>ğŸ–¼ï¸ å“ç‰ŒLogo</label>
                    <div class="upload-area" onclick="document.getElementById('logoInput').click()">
                        <div class="upload-icon">ğŸ“¤</div>
                        <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ Logoå›¾ç‰‡</div>
                        <div class="upload-text" style="margin-top: 5px; font-size: 0.75rem;">æ”¯æŒ PNG, JPG, GIF æ ¼å¼</div>
                    </div>
                    <input type="file" id="logoInput" class="upload-input" accept="image/*">
                    <div class="logo-preview" id="logoPreview">
                        <img id="logoImg" alt="Logoé¢„è§ˆ">
                        <button class="remove-logo" onclick="removeLogo()">åˆ é™¤Logo</button>
                    </div>
                </div>

                <!-- ç”Ÿæˆå’Œä¸‹è½½æŒ‰é’® -->
                <div class="button-group">
                    <button class="btn btn-primary" onclick="generateQR()">ğŸš€ ç”ŸæˆäºŒç»´ç </button>
                    <button class="btn btn-secondary" onclick="downloadQR()">ğŸ’¾ ä¸‹è½½</button>
                </div>

                <div class="loading" id="loading">â³ æ­£åœ¨ç”ŸæˆäºŒç»´ç ...</div>
                <div class="success-message" id="successMessage">âœ… äºŒç»´ç ç”ŸæˆæˆåŠŸï¼</div>
            </div>

            <!-- å³ä¾§é¢„è§ˆé¢æ¿ -->
            <div class="preview-section">
                <h2 style="margin-bottom: 25px; color: #374151;">ğŸ‘ï¸ è¯—æ„å›¾æ™¯</h2>
                <div class="qr-display">
                    <img id="qrImage" class="qr-image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjRjNGNEY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzZCNzI4MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWbvueJh+eMhuaXpeW8mzwvdGV4dD48L3N2Zz4=" alt="äºŒç»´ç é¢„è§ˆ">
                </div>
                <p style="color: #6b7280; font-size: 0.875rem; margin-top: 15px;">
                    ç‰‡åˆ»èŠ³åï¼Œæµè½¬äºæ•°å­—ä¹‹é—´<br>
                    <strong>å€¾ä¸–ä¹‹ç¾ï¼Œèäºä»£ç ä¹‹é­‚</strong>
                </p>
                
                <!-- å¿«æ·æ“ä½œæŒ‰é’® -->
                <div class="action-buttons">
                    <button class="action-btn reset" onclick="resetAll()">ğŸ”„ ä¸€é”®é‡ç½®</button>
                    <button class="action-btn" onclick="previewScan()">ğŸ“± æ‰«ç é¢„è§ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLogo = null;
        let currentForeground = '#6B7280';
        let currentBackground = '#F3F4F6';

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªé…è‰²
            document.querySelector('.color-preset').classList.add('active');
            // ç¡®ä¿é…è‰²é¢æ¿é»˜è®¤æ”¶èµ·
            isColorsExpanded = false;
        });

        function setupEventListeners() {
            // é…è‰²æ–¹æ¡ˆé€‰æ‹©
            document.querySelectorAll('.color-preset').forEach(preset => {
                preset.addEventListener('click', function() {
                    // ç§»é™¤å…¶ä»–æ´»åŠ¨çŠ¶æ€
                    document.querySelectorAll('.color-preset').forEach(p => p.classList.remove('active'));
                    // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
                    this.classList.add('active');
                    
                    currentForeground = this.dataset.foreground;
                    currentBackground = this.dataset.background;
                });
            });

            // æ–‡ä»¶ä¸Šä¼ 
            const logoInput = document.getElementById('logoInput');
            logoInput.addEventListener('change', handleLogoUpload);

            // æ‹–æ‹½ä¸Šä¼ 
            const uploadArea = document.querySelector('.upload-area');
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleLogoFile(files[0]);
                }
            });
        }

        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                handleLogoFile(file);
            }
        }

        function handleLogoFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                currentLogo = e.target.result;
                showLogoPreview();
            };
            reader.readAsDataURL(file);
        }

        function showLogoPreview() {
            const logoPreview = document.getElementById('logoPreview');
            const logoImg = document.getElementById('logoImg');
            
            logoImg.src = currentLogo;
            logoPreview.style.display = 'block';
        }

        function removeLogo() {
            currentLogo = null;
            document.getElementById('logoPreview').style.display = 'none';
            document.getElementById('logoInput').value = '';
        }

        function generateQR() {
            const content = document.getElementById('content').value.trim();

            // éªŒè¯è¾“å…¥
            if (!content) {
                document.getElementById('contentError').style.display = 'block';
                return;
            } else {
                document.getElementById('contentError').style.display = 'none';
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loading').style.display = 'block';
            document.getElementById('successMessage').style.display = 'none';

            try {
                // åˆ›å»ºåŸºç¡€äºŒç»´ç 
                const apiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(content)}&color=${currentForeground.replace('#', '')}&bgcolor=${currentBackground.replace('#', '')}&format=svg`;
                
                const qrImage = new Image();
                qrImage.crossOrigin = 'anonymous';
                
                qrImage.onload = function() {
                    if (currentLogo) {
                        composeWithLogo(qrImage);
                    } else {
                        displayQR(qrImage);
                    }
                };
                
                qrImage.onerror = function() {
                    document.getElementById('loading').style.display = 'none';
                    alert('ç”ŸæˆäºŒç»´ç å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                };
                
                qrImage.src = apiUrl;
                
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                alert('ç”ŸæˆäºŒç»´ç æ—¶å‘ç”Ÿé”™è¯¯ï¼š' + error.message);
            }
        }

        function composeWithLogo(qrImage) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 400;
            canvas.height = 400;
            
            // ç»˜åˆ¶äºŒç»´ç 
            ctx.drawImage(qrImage, 0, 0, 400, 400);
            
            // åˆ›å»ºLogoå›¾åƒ
            const logoImg = new Image();
            logoImg.onload = function() {
                // è®¡ç®—Logoå¤§å°ï¼ˆQRç çš„12%ï¼‰
                const logoSize = 400 * 0.12;
                const logoX = (400 - logoSize) / 2;
                const logoY = (400 - logoSize) / 2;
                
                // ç»˜åˆ¶ç™½è‰²èƒŒæ™¯åœ†è§’çŸ©å½¢
                const bgRadius = logoSize * 0.15;
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.roundRect(logoX - 5, logoY - 5, logoSize + 10, logoSize + 10, bgRadius);
                ctx.fill();
                
                // ç»˜åˆ¶Logo
                ctx.drawImage(logoImg, logoX, logoY, logoSize, logoSize);
                
                displayQR(canvas);
            };
            
            logoImg.src = currentLogo;
        }

        function displayQR(imageSource) {
            const qrImage = document.getElementById('qrImage');
            qrImage.src = imageSource instanceof HTMLCanvasElement ? imageSource.toDataURL() : imageSource.src;
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('successMessage').style.display = 'block';
            
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 3000);
        }

        function downloadQR() {
            const qrImage = document.getElementById('qrImage');
            const link = document.createElement('a');
            link.href = qrImage.src;
            link.download = 'qrcode-' + Date.now() + '.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // æ–°å¢åŠŸèƒ½å‡½æ•°
        let isColorsExpanded = false;
        
        function toggleColors() {
            const colorPresets = document.querySelector('.color-presets');
            const toggleBtn = document.querySelector('.toggle-btn');
            isColorsExpanded = !isColorsExpanded;
            
            if (isColorsExpanded) {
                colorPresets.classList.add('expanded');
                toggleBtn.textContent = 'ğŸ“ æ”¶èµ·é…è‰²';
            } else {
                colorPresets.classList.remove('expanded');
                toggleBtn.textContent = 'ğŸ“ å±•å¼€æ›´å¤šé…è‰²';
            }
        }
        
        function resetAll() {
            // é‡ç½®å†…å®¹
            document.getElementById('content').value = 'https://www.example.com';
            
            // é‡ç½®é…è‰²ä¸ºé»˜è®¤
            document.querySelectorAll('.color-preset').forEach(p => p.classList.remove('active'));
            document.querySelector('.color-preset').classList.add('active');
            currentForeground = '#6B7280';
            currentBackground = '#F3F4F6';
            
            // åˆ é™¤Logo
            if (currentLogo) {
                removeLogo();
            }
            
            // é‡ç½®äºŒç»´ç æ˜¾ç¤º
            document.getElementById('qrImage').src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjRjNGNEY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzZCNzI4MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWbvueJh+eMhuaXpeW8mzwvdGV4dD48L3N2Zz4=';
            
            // éšè—é”™è¯¯å’ŒæˆåŠŸæ¶ˆæ¯
            document.getElementById('contentError').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
            
            // æ”¶èµ·é…è‰²é¢æ¿
            if (isColorsExpanded) {
                toggleColors();
            }
        }
        
        function previewScan() {
            const qrImage = document.getElementById('qrImage');
            const content = document.getElementById('content').value.trim();
            
            if (!content) {
                alert('è¯·å…ˆè¾“å…¥è¦ç”ŸæˆäºŒç»´ç çš„å†…å®¹ï¼');
                return;
            }
            
            if (qrImage.src.includes('data:image/svg+xml;base64') && !qrImage.src.includes('PHN2ZyB3aWR0aD0iMzAw')) {
                alert('è¯·å…ˆç”ŸæˆäºŒç»´ç åå†è¿›è¡Œæ‰«ç é¢„è§ˆï¼');
                return;
            }
            
            // åˆ›å»ºä¸€ä¸ªæ–°çš„çª—å£æ˜¾ç¤ºäºŒç»´ç è¿›è¡Œæ‰«ç æµ‹è¯•
            const scanWindow = window.open('', '_blank', 'width=600,height=700,scrollbars=yes,resizable=yes');
            scanWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>äºŒç»´ç æ‰«ç é¢„è§ˆ</title>
                    <meta charset="utf-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <style>
                        body {
                            font-family: 'Segoe UI', Arial, sans-serif;
                            margin: 0;
                            padding: 20px;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            min-height: 100vh;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                        }
                        .scan-container {
                            background: white;
                            padding: 30px;
                            border-radius: 20px;
                            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                            text-align: center;
                            max-width: 500px;
                        }
                        h1 {
                            color: #2d3748;
                            margin-bottom: 20px;
                            font-size: 1.8rem;
                        }
                        .qr-display {
                            margin: 20px 0;
                            padding: 20px;
                            background: #f7fafc;
                            border-radius: 15px;
                        }
                        .qr-image {
                            max-width: 300px;
                            max-height: 300px;
                            border-radius: 10px;
                        }
                        .scan-instructions {
                            color: #4a5568;
                            font-size: 1rem;
                            margin-top: 20px;
                            line-height: 1.6;
                        }
                        .warning {
                            background: #fed7d7;
                            color: #c53030;
                            padding: 15px;
                            border-radius: 8px;
                            margin-top: 20px;
                            font-size: 0.9rem;
                        }
                        .close-btn {
                            background: #4f46e5;
                            color: white;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 1rem;
                            margin-top: 20px;
                            transition: background 0.3s;
                        }
                        .close-btn:hover {
                            background: #3730a3;
                        }
                    </style>
                </head>
                <body>
                    <div class="scan-container">
                        <h1>ğŸ“± äºŒç»´ç æ‰«ç é¢„è§ˆ</h1>
                        <div class="qr-display">
                            <img src="${qrImage.src}" alt="äºŒç»´ç " class="qr-image">
                        </div>
                        <div class="scan-instructions">
                            <p>è¯·ä½¿ç”¨æ‰‹æœºæ‰«æå™¨æˆ–æ‰«æåº”ç”¨</p>
                            <p>æ‰«æå†…å®¹ï¼š<strong>${content}</strong></p>
                        </div>
                        <div class="warning">
                            ğŸ’¡ æç¤ºï¼šå¦‚æ— æ³•æ‰«æï¼Œè¯·æ£€æŸ¥äºŒç»´ç æ¸…æ™°åº¦ã€å¯¹æ¯”åº¦å’Œå°ºå¯¸
                        </div>
                        <button class="close-btn" onclick="window.close()">å…³é—­é¢„è§ˆ</button>
                    </div>
                </body>
                </html>
            `);
        }
    </script>
</body>
</html>
